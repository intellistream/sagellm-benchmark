name: Trigger Website Sync

# âš ï¸ SETUP REQUIRED:
# éœ€è¦åœ¨ä»“åº“ Settings â†’ Secrets â†’ Actions æ·»åŠ  PAT_TOKEN
# ç”¨äºè§¦å‘ sagellm-website çš„åŒæ­¥ workflow
#
# PAT åˆ›å»ºæ­¥éª¤ï¼š
# 1. GitHub Settings â†’ Developer settings â†’ Personal access tokens â†’ Tokens (classic)
# 2. æƒé™é€‰æ‹©ï¼šrepo (Full control) æˆ– public_repo (ä»…å…¬å¼€ä»“åº“)
# 3. æ·»åŠ åˆ° sagellm-benchmark ä»“åº“çš„ Secretsï¼Œå‘½åä¸º PAT_TOKEN

on:
  push:
    branches:
      - main
      - main-dev
    paths:
      - 'outputs/**/*_leaderboard.json'

jobs:
  trigger-sync:
    runs-on: ubuntu-latest
    
    steps:
      - name: Trigger website sync workflow
        run: |
          curl -L \
            -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.PAT_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/intellistream/sagellm-website/dispatches \
            -d '{"event_type":"benchmark-updated","client_payload":{"repository":"${{ github.repository }}","branch":"${{ github.ref_name }}","commit":"${{ github.sha }}","pusher":"${{ github.actor }}"}}'
          
          echo "âœ… Triggered sagellm-website sync workflow"
          echo "ğŸ“ Repository: ${{ github.repository }}"
          echo "ğŸŒ¿ Branch: ${{ github.ref_name }}"
          echo "ğŸ“ Commit: ${{ github.sha }}"
